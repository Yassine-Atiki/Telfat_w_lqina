<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.Double?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Polygon?>
<?import javafx.scene.shape.Rectangle?>
<?import javafx.scene.text.Font?>

<StackPane style="-fx-background-color: transparent;" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.firstproject.telfat_w_lqina.controllers.ChangePasswordController">

    <!-- Motif dÃ©coratif en arriÃ¨re-plan -->
    <HBox alignment="TOP_RIGHT" opacity="0.03" spacing="-10" style="-fx-padding: 20;">
        <Polygon fill="#006233" rotate="0">
            <points>
                <Double fx:value="0.0" /> <Double fx:value="-30.0" />
                <Double fx:value="26.0" /> <Double fx:value="-15.0" />
                <Double fx:value="26.0" /> <Double fx:value="15.0" />
                <Double fx:value="0.0" /> <Double fx:value="30.0" />
                <Double fx:value="-26.0" /> <Double fx:value="15.0" />
                <Double fx:value="-26.0" /> <Double fx:value="-15.0" />
            </points>
        </Polygon>
        <Polygon fill="#C1272D" rotate="30">
            <points>
                <Double fx:value="0.0" /> <Double fx:value="-30.0" />
                <Double fx:value="26.0" /> <Double fx:value="-15.0" />
                <Double fx:value="26.0" /> <Double fx:value="15.0" />
                <Double fx:value="0.0" /> <Double fx:value="30.0" />
                <Double fx:value="-26.0" /> <Double fx:value="15.0" />
                <Double fx:value="-26.0" /> <Double fx:value="-15.0" />
            </points>
        </Polygon>
    </HBox>

    <!-- Contenu principal (popup compact centrÃ©) -->
    <VBox fx:id="popupContainer" alignment="CENTER" maxWidth="480.0" prefWidth="480.0" spacing="0" style="-fx-background-color: white; -fx-background-radius: 16; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.18), 18, 0, 0, 6);">
        <VBox.margin>
            <Insets bottom="12" left="12" right="12" top="12" />
        </VBox.margin>

        <!-- En-tÃªte avec icÃ´ne -->
        <VBox alignment="CENTER" spacing="12" style="-fx-background-color: linear-gradient(to bottom, #006233, #007d42); -fx-background-radius: 16 16 0 0; -fx-padding: 25 20;">
            <!-- IcÃ´ne de cadenas stylÃ©e -->
            <StackPane prefHeight="70" prefWidth="70">
                <Polygon fill="white" opacity="0.2">
                    <points>
                        <Double fx:value="0.0" /> <Double fx:value="-40.0" />
                        <Double fx:value="35.0" /> <Double fx:value="-20.0" />
                        <Double fx:value="35.0" /> <Double fx:value="20.0" />
                        <Double fx:value="0.0" /> <Double fx:value="40.0" />
                        <Double fx:value="-35.0" /> <Double fx:value="20.0" />
                        <Double fx:value="-35.0" /> <Double fx:value="-20.0" />
                    </points>
                </Polygon>
                <Label text="ðŸ”" style="-fx-font-size: 42px;">
                    <effect>
                        <DropShadow color="#00000020" radius="3.0" />
                    </effect>
                </Label>
            </StackPane>

            <VBox alignment="CENTER" spacing="5">
                <Label text="Changement de mot de passe requis" style="-fx-text-fill: white; -fx-font-weight: bold;">
                    <font>
                        <Font name="System Bold" size="20.0" />
                    </font>
                </Label>
                <Label text="Pour des raisons de sÃ©curitÃ©, veuillez changer votre mot de passe" style="-fx-text-fill: rgba(255,255,255,0.9); -fx-text-alignment: center;" wrapText="true">
                    <font>
                        <Font size="13.0" />
                    </font>
                </Label>
            </VBox>
        </VBox>

        <!-- Ligne dÃ©corative -->
        <HBox alignment="CENTER" prefHeight="3.0" spacing="3" style="-fx-background-color: white;">
            <Rectangle fill="#C1272D" height="3.0" width="30.0" />
            <Rectangle fill="#006233" height="3.0" width="10.0" />
            <Rectangle fill="#C1272D" height="3.0" width="30.0" />
        </HBox>

        <!-- Formulaire (compact) -->
        <VBox spacing="10" style="-fx-padding: 14 26 8 26; -fx-alignment: center;">

            <!-- Mot de passe actuel -->
            <VBox spacing="8">
                <Label text="ðŸ”‘  Mot de passe actuel" style="-fx-text-fill: #495057; -fx-font-weight: bold;">
                    <font>
                        <Font name="System Bold" size="12.0" />
                    </font>
                </Label>
                <PasswordField fx:id="currentPasswordField" promptText="Entrez votre mot de passe actuel" style="-fx-background-color: white; -fx-border-color: #ced4da; -fx-border-width: 2; -fx-border-radius: 8; -fx-background-radius: 8; -fx-padding: 10; -fx-font-size: 13;">
                    <effect>
                        <DropShadow color="#00000005" offsetY="1.0" radius="2.0" />
                    </effect>
                </PasswordField>
            </VBox>

            <!-- Nouveau mot de passe -->
            <VBox spacing="8">
                <Label text="ðŸ†•  Nouveau mot de passe" style="-fx-text-fill: #495057; -fx-font-weight: bold;">
                    <font>
                        <Font name="System Bold" size="12.0" />
                    </font>
                </Label>
                <PasswordField fx:id="newPasswordField" promptText="Minimum 6 caractÃ¨res" style="-fx-background-color: white; -fx-border-color: #ced4da; -fx-border-width: 2; -fx-border-radius: 8; -fx-background-radius: 8; -fx-padding: 10; -fx-font-size: 13;">
                    <effect>
                        <DropShadow color="#00000005" offsetY="1.0" radius="2.0" />
                    </effect>
                </PasswordField>
            </VBox>

            <!-- Confirmer le mot de passe -->
            <VBox spacing="6">
                <Label text="âœ…  Confirmer le mot de passe" style="-fx-text-fill: #495057; -fx-font-weight: bold;">
                    <font>
                        <Font name="System Bold" size="12.0" />
                    </font>
                </Label>
                <PasswordField fx:id="confirmPasswordField" promptText="Retapez le nouveau mot de passe" style="-fx-background-color: white; -fx-border-color: #ced4da; -fx-border-width: 2; -fx-border-radius: 8; -fx-background-radius: 8; -fx-padding: 10; -fx-font-size: 13;">
                    <effect>
                        <DropShadow color="#00000005" offsetY="1.0" radius="2.0" />
                    </effect>
                </PasswordField>
            </VBox>

            <!-- Messages d'erreur et succÃ¨s (compact) -->
            <VBox spacing="6">
                <Label fx:id="errorLabel" text="" style="-fx-text-fill: #dc3545; -fx-background-color: #f8d7da; -fx-background-radius: 6; -fx-padding: 8 12; -fx-border-color: #f5c6cb; -fx-border-width: 1; -fx-border-radius: 6;" visible="false" wrapText="true">
                    <font>
                        <Font name="System Bold" size="12.0" />
                    </font>
                </Label>

                <Label fx:id="successLabel" text="" style="-fx-text-fill: #155724; -fx-background-color: #d4edda; -fx-background-radius: 6; -fx-padding: 8 12; -fx-border-color: #c3e6cb; -fx-border-width: 1; -fx-border-radius: 6;" visible="false" wrapText="true">
                    <font>
                        <Font name="System Bold" size="12.0" />
                    </font>
                </Label>
            </VBox>

            <!-- Boutons d'action (rÃ©duit l'espace entre confirm et bouton) -->
            <HBox alignment="CENTER" spacing="12" style="-fx-padding: 6 0 0 0;">
                <Button onAction="#handleChangePassword" prefHeight="42" prefWidth="200" style="-fx-background-color: linear-gradient(to right, #006233, #007d42); -fx-text-fill: white; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-weight: bold;" text="ðŸ”’  Changer le mot de passe">
                    <font>
                        <Font name="System Bold" size="13.0" />
                    </font>
                    <effect>
                        <DropShadow color="#00623340" offsetY="2.0" radius="6.0" />
                    </effect>
                </Button>
            </HBox>

            <!-- Note de sÃ©curitÃ© -->
            <HBox alignment="CENTER" spacing="8" style="-fx-padding: 10 0 0 0;">
                <Label text="ðŸ›¡ï¸" style="-fx-font-size: 14px;" />
                <Label text="Votre mot de passe doit contenir au moins 6 caractÃ¨res" style="-fx-text-fill: #6c757d; -fx-font-size: 11; -fx-text-alignment: center;" wrapText="true">
                    <font>
                        <Font name="System Italic" size="11.0" />
                    </font>
                </Label>
            </HBox>
        </VBox>

    </VBox>

    <!-- Centre popup dans le StackPane en utilisant alignment -->
    <StackPane.margin>
        <Insets top="0" bottom="0" left="0" right="0" />
    </StackPane.margin>

</StackPane>

